# 221210_TS

## javascript heap out of memory 에러 해결

### 상황

![image](https://user-images.githubusercontent.com/93081720/206988779-629f43f9-0aa0-4eec-af47-e0c082de80f3.png)

(사진은 당시 남기지 못해서 구글 이미지에서 가져옴)

AWS EC2에 공통 프로젝트를 배포하기 위해 프론트엔드 이미지를 빌드하는 도중에 위 사진과 같이 

`javascript heap out of memory`라는 에러가 발생하였다.

원래 로컬에서 이미지를 빌드하려다가 굳이 그럴 필요가 없이 EC2에서 바로 빌드하는 것이 낫겠다 싶어서 EC2에서 빌드 도중 위와 같은 에러가 발생한 것이다.

### 경과

말 그대로 메모리가 부족하다는 의미여서 EC2 메모리가 부족해서 생기는 것이구나 생각했다.

그래서 로컬에서 빌드를 하려했는데, 동일한 에러가 또 발생하는 것이었다.

### 원인

EC2에서 에러가 발생한 이유는 EC2 프리티어 메모리가 작아서 그런 것이었고,

로컬에서도 똑같은 에러가 발생한 이유는 Docker Desktop에 VM의 허용 메모리 설정을 작게 잡아둬서 생긴 문제였다.

![image](https://user-images.githubusercontent.com/93081720/206990040-82cd9b88-0a42-42fd-95c7-3c9fbd7906f1.png)

### 조치

Docker Desktop의 허용 메모리를 늘려주기 위해 wslconfig 설정 파일의 내용을 수정하였다.

위치: `내 PC` - `로컬디스크` - `사용자` - `유저 아이디`

![image](https://user-images.githubusercontent.com/93081720/206990346-17a39812-991c-4f72-8192-e550277c5ef2.png)

에서 `memory` 부분을 원하는 용량으로 수정해주면 된다.

![image](https://user-images.githubusercontent.com/93081720/206990531-9ae82106-27d8-4231-9758-0cadc1a3abf5.png)

### 결론

예전에 Docker Desktop을 켰을 때, 현재 Docker를 그렇게 많이 사용하고 있지도 않은데 VM이 많은 메모리를 차지하고 있길래 메모리 사용량을 줄이는 방법을 찾아서 설정을 수정해줬던 게 화근이었다.

당시 2GB로 수정해놓았었는데, 이를 4GB로 올리니까 성공적으로 로컬에서 이미지를 빌드할 수 있었다.

최근에 동기의 자율 프로젝트를 배포해주면서 프론트엔드 이미지를 빌드했는데 꽤 빠른 속도로 이미지를 빌드할 수 있었다. 되게 최적화가 잘 된 프로젝트였는데, 이런 것을 보면 확실히 우리 공통 프로젝트는 최적화를 하지 못했다는 것에 반성을 해본다. 아마 당시 내가 프론트 최적화에 크게 관심이 없어서 더 그랬는지도 모르겠다.